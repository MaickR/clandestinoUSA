"use strict";const $=e=>document.querySelector(e),$$=e=>Array.from(document.querySelectorAll(e));!function(){var e=document.querySelector(".clandestino-preloader");if(e){var t=e.querySelector(".clandestino-preloader-progress-bar");e.querySelector(".clandestino-preloader-progress-text");document.documentElement.classList.add("clandestino-preloader-lock"),document.body.classList.add("clandestino-preloader-lock");var n,a=0;n=setInterval(function(){a<90&&(a+=a<30?2:a<60?1.5:.5,t&&(t.style.width=a+"%"))},100);var s=setTimeout(i,1e4);window.addEventListener("load",function(){clearTimeout(s),a=100,setTimeout(i,600)})}function i(){e&&(t&&(t.style.width="100%"),clearInterval(n),setTimeout(function(){e.classList.add("_hide"),document.documentElement.classList.remove("clandestino-preloader-lock"),document.body.classList.remove("clandestino-preloader-lock"),setTimeout(function(){e&&e.parentNode&&(e.parentNode.removeChild(e),e=null),("/"===window.location.pathname||window.location.pathname.endsWith("/index.html")||window.location.pathname.endsWith("/"))&&initClosureModal()},800)},200))}}(),function(){const e=document.getElementById("clandestino-reservation-form");if(!e)return;const t=e.querySelector('select[name="guests"]'),n=e.querySelector('input[name="date"]'),a=e.querySelector('select[name="time"]'),s=e.querySelector('select[name="eventType"]'),i=e.querySelector("#custom-event-extra"),r=document.getElementById("estimated-price"),o=document.getElementById("price-breakdown"),l=document.getElementById("availability-status"),c=document.getElementById("mini-calendar"),d=document.getElementById("reservation-submit"),u=new Date,p=new Date(u.getFullYear(),u.getMonth(),u.getDate());p.setDate(p.getDate()+2);const m=p.toISOString().split("T")[0],g=new Set,f=new Date(p);f.setDate(f.getDate()+1),g.add(`${f.toISOString().split("T")[0]}|17:00`);const h=new Date(p);h.setDate(h.getDate()+2),g.add(`${h.toISOString().split("T")[0]}|18:00`);const v="clandestinoReservations";function y(){try{return JSON.parse(localStorage.getItem(v))||[]}catch(e){return[]}}function w(e,t){const n=`${e}|${t}`;return y().some(e=>e.dt===n)}!function(){const e=y().filter(e=>{const[t]=e.dt.split("|");return t>=m});localStorage.setItem(v,JSON.stringify(e))}();const b={standard:17,romantic:28,birthday:22,anniversary:24,family:18,holiday:26,tasting:35,corporate:30,custom:22};function S(e){return"$"+Math.round(e)}function E(){const i=parseInt(t.value||"0",10);if(!i)return r.textContent="$0",void(o.innerHTML="");const l=s.value||"standard",c=n.value,d=a.value,u=b[l]||b.standard;let p=i*u;const m=(e=>{if(!e)return 0;const t=new Date(e+"T00:00:00").getDay();return 5===t||6===t?.08:0===t?.05:0})(c),g=(e=>{if(!e)return 0;const t=parseInt(e.split(":")[0],10);return t>=19?.07:t>=18?.05:0})(d);let f=p*(1+m+g),h=0;const v=[];if(v.push(`<li><span>Base (${i} x ${S(u)})</span><span>${S(p)}</span></li>`),m){const e=p*m;v.push(`<li><span>Weekend Adj.</span><span>${S(e)}</span></li>`)}if(g){const e=p*g;v.push(`<li><span>Evening Adj.</span><span>${S(e)}</span></li>`)}if("romantic"===l&&(h+=18,v.push(`<li><span>Romantic Touch</span><span>${S(18)}</span></li>`)),"tasting"===l&&(h+=12,v.push(`<li><span>Tasting Curation</span><span>${S(12)}</span></li>`)),"corporate"===l&&(h+=25,v.push(`<li><span>Corporate Setup</span><span>${S(25)}</span></li>`)),"holiday"===l&&(h+=20,v.push(`<li><span>Seasonal Elements</span><span>${S(20)}</span></li>`)),"custom"===l){const t=parseInt(e.duration?.value||"0",10);if(t>0){const e=10*t;h+=e,v.push(`<li><span>Extra Duration (${t}h)</span><span>${S(e)}</span></li>`)}const n=e.winePreference?.value;"premium"===n&&(h+=40,v.push(`<li><span>Premium Wine Focus</span><span>${S(40)}</span></li>`)),"mixed"===n&&(h+=18,v.push(`<li><span>Mixed Wine Selection</span><span>${S(18)}</span></li>`))}f+=h;const y=.1*f;v.push(`<li><span>Est. Service & Tax (10%)</span><span>${S(y)}</span></li>`);let w=f+y;w<12*i&&(w=12*i),r.textContent=S(w),o.innerHTML=v.join(""),r.dataset.base=w.toFixed(0)}function L(){const e=n.value,t=a.value;if(!e||!t)return l.textContent="Seleccione fecha y hora.",void(l.className="availability-status");if(e<m)return l.textContent="Debe reservar con mínimo 48 horas de anticipación.",l.className="availability-status conflict",void(d.disabled=!0);if(function(e,t){if(!e)return!1;const[n,a]=(t||"00:00").split(":").map(e=>parseInt(e,10));return new Date(`${e}T${String(n).padStart(2,"0")}:${String(a).padStart(2,"0")}:00`).getTime()<Date.now()}(e,t))return l.textContent="La hora seleccionada ya pasó.",l.className="availability-status conflict",void(d.disabled=!0);const s=`${e}|${t}`;if(g.has(s)||w(e,t)){const n=function(e,t){const[n,a]=t.split(":");let s=new Date(`${e}T${n}:${a}:00`);for(let e=0;e<6;e++){s=new Date(s.getTime()+18e5);const e=s.toISOString().split("T")[0],t=s.toTimeString().slice(0,5);if(!(e<m||g.has(`${e}|${t}`)||w(e,t)))return`${e} ${t}`}const i=new Date(`${e}T${n}:${a}:00`);i.setDate(i.getDate()+1);const r=i.toISOString().split("T")[0],o=`${n}:${a}`;return g.has(`${r}|${o}`)||w(r,o)?null:`${r} ${o}`}(e,t);l.textContent="Ese horario ya está reservado."+(n?` Sugerencia: ${n}`:" Elija otro."),l.className="availability-status conflict",d.disabled=!0}else l.textContent="Disponible provisionalmente.",l.className="availability-status ok"}function x(){if(!e.accept.checked)return void(d.disabled=!0);const t=e.checkValidity();d.disabled=!t}function k(e){return e?String(e).replace(/[<>]/g,"").trim().slice(0,180):""}!function e(t){c.innerHTML="";const a=document.createElement("div");a.className="calendar-header";const s=document.createElement("button");s.className="calendar-nav",s.type="button",s.innerHTML="&#8249;";const i=document.createElement("button");i.className="calendar-nav",i.type="button",i.innerHTML="&#8250;";const r=document.createElement("div");r.style.fontSize="1.2rem",r.style.fontWeight="600",a.append(s,r,i),c.appendChild(a);const o=t.getMonth(),l=t.getFullYear();r.textContent=t.toLocaleString(void 0,{month:"long",year:"numeric"}),["Su","Mo","Tu","We","Th","Fr","Sa"].forEach(e=>{const t=document.createElement("div");t.textContent=e,t.className="weekday",c.appendChild(t)});const d=new Date(l,o,1).getDay();for(let e=0;e<d;e++){const e=document.createElement("div");c.appendChild(e)}const u=new Date(l,o+1,0).getDate();for(let e=1;e<=u;e++){const t=`${l}-${String(o+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`,a=document.createElement("button");a.type="button",a.textContent=e,a.className="day",t<m&&a.classList.add("unavailable"),a.addEventListener("click",()=>{a.classList.contains("unavailable")||(n.value=t,c.querySelectorAll(".day").forEach(e=>e.classList.remove("selected")),a.classList.add("selected"),L(),E(),x())}),n.value===t&&a.classList.add("selected"),c.appendChild(a)}s.addEventListener("click",()=>{t.setMonth(t.getMonth()-1),e(t)}),i.addEventListener("click",()=>{t.setMonth(t.getMonth()+1),e(t)})}(new Date),c.setAttribute("aria-hidden","false"),["change","input"].forEach(n=>{e.addEventListener(n,e=>{e.target===s&&("custom"===s.value?(i.classList.remove("hidden"),i.setAttribute("aria-hidden","false")):(i.classList.add("hidden"),i.setAttribute("aria-hidden","true")),E()),(e.target===t||e.target===a||e.target.closest("#custom-event-extra"))&&E(),e.target===a&&L(),x()})}),e.accept.addEventListener("change",x),E(),L(),x(),e.addEventListener("submit",function(t){if(t.preventDefault(),d.disabled)return;E();const n=new FormData(e),a=e.querySelectorAll('input[name="diet"]:checked'),s=Array.from(a).map(e=>e.value).join(", ")||"None",i=r.dataset.base||"0",o=[];var l;o.push("*Reservation Request*"),o.push(`Name: ${k(n.get("name"))}`),o.push(`Phone: ${l=n.get("phone"),(l||"").replace(/[^0-9+]/g,"").slice(0,18)}`),o.push(`Guests: ${k(n.get("guests"))}`),o.push(`Date: ${k(n.get("date"))}`),o.push(`Time: ${k(n.get("time"))}`),o.push(`Event Type: ${k(n.get("eventType"))}`),"custom"===n.get("eventType")&&(n.get("customTitle")&&o.push(`Custom Title: ${k(n.get("customTitle"))}`),n.get("duration")&&o.push(`Duration (h): ${k(n.get("duration"))}`),n.get("winePreference")&&o.push(`Wine Pref: ${k(n.get("winePreference"))}`)),o.push(`Dietary: ${s}`),n.get("budget")&&o.push(`Budget: ${k(n.get("budget"))}`),n.get("notes")&&o.push(`Notes: ${k(n.get("notes"))}`),o.push(`Estimated: $${i} (subject to confirmation)`);const c=encodeURIComponent(o.join("\n"));!function(e,t,n,a){const s=y();s.push({dt:`${e}|${t}`,name:n.slice(0,60),guests:a,ts:Date.now()}),localStorage.setItem(v,JSON.stringify(s))}(k(n.get("date")),k(n.get("time")),k(n.get("name")),k(n.get("guests")));const u=`https://wa.me/14086090027?text=${c}`;window.open(u,"_blank"),L()})}();const addEventOnElements=(e,t,n)=>{e.forEach(e=>e.addEventListener(t,n))},navbar=$("[data-navbar]"),navTogglers=$$("[data-nav-toggler]"),overlay=$("[data-overlay]"),toggleNavbar=()=>{navbar&&(navbar.classList.toggle("active"),overlay&&overlay.classList.toggle("active"),document.body.classList.toggle("nav-active"))};addEventOnElements(navTogglers,"click",toggleNavbar),function(){const e=$$(".has-submenu");e.length&&(e.forEach(e=>{const t=e.querySelector(":scope > .navbar-link"),n=e.querySelector(":scope > .submenu");if(t&&n){if(!t.querySelector(".submenu-toggle-icon")){const e=document.createElement("span");e.className="submenu-toggle-icon",e.setAttribute("aria-hidden","true"),e.innerHTML="▾",t.appendChild(e)}t.setAttribute("aria-haspopup","true"),t.setAttribute("aria-expanded","false"),n.setAttribute("role","menu"),t.addEventListener("click",n=>{n.preventDefault();const a=e.classList.toggle("open");t.setAttribute("aria-expanded",String(a))})}}),document.addEventListener("click",t=>{window.innerWidth>1024||t.target.closest(".has-submenu")||e.forEach(e=>{if(e.classList.contains("open")){e.classList.remove("open");const t=e.querySelector(":scope > .navbar-link");t&&t.setAttribute("aria-expanded","false")}})}),document.addEventListener("keydown",t=>{"Escape"===t.key&&e.forEach(e=>{if(e.classList.contains("open")){e.classList.remove("open");const t=e.querySelector(":scope > .navbar-link");t&&t.setAttribute("aria-expanded","false")}})}),window.addEventListener("resize",()=>{window.innerWidth>1024&&$$(".has-submenu.open").forEach(e=>{e.classList.remove("open");const t=e.querySelector(":scope > .navbar-link");t&&t.setAttribute("aria-expanded","false")})}))}();const header=$("[data-header]"),backTopBtn=$("[data-back-top-btn]");let lastScrollPos=0,scrollTimeout=null;const hideHeader=()=>{lastScrollPos<window.scrollY?header&&header.classList.add("hide"):header&&header.classList.remove("hide"),lastScrollPos=window.scrollY};window.addEventListener("scroll",()=>{window.scrollY>=50?(header&&header.classList.add("active"),backTopBtn&&backTopBtn.classList.add("active"),clearTimeout(scrollTimeout),scrollTimeout=setTimeout(hideHeader,50)):(header&&header.classList.remove("active"),backTopBtn&&backTopBtn.classList.remove("active"),header&&header.classList.remove("hide"))},{passive:!0});const heroSlider=$("[data-hero-slider]"),heroSliderItems=$$("[data-hero-slider-item]"),heroSliderPrevBtn=$("[data-prev-btn]"),heroSliderNextBtn=$("[data-next-btn]");let currentSlidePos=0,lastActiveSliderItem=heroSliderItems[0];const updateSliderPos=()=>{lastActiveSliderItem&&(lastActiveSliderItem.classList.remove("active"),heroSliderItems[currentSlidePos].classList.add("active"),lastActiveSliderItem=heroSliderItems[currentSlidePos])},slideNext=()=>{currentSlidePos>=heroSliderItems.length-1?currentSlidePos=0:currentSlidePos++,updateSliderPos()},slidePrev=()=>{currentSlidePos<=0?currentSlidePos=heroSliderItems.length-1:currentSlidePos--,updateSliderPos()};let autoSlideInterval;heroSliderNextBtn&&heroSliderNextBtn.addEventListener("click",slideNext),heroSliderPrevBtn&&heroSliderPrevBtn.addEventListener("click",slidePrev);const autoSlide=()=>{autoSlideInterval=setInterval(slideNext,7e3)};window.addEventListener("load",autoSlide),addEventOnElements([heroSliderNextBtn,heroSliderPrevBtn].filter(Boolean),"mouseover",()=>clearInterval(autoSlideInterval)),addEventOnElements([heroSliderNextBtn,heroSliderPrevBtn].filter(Boolean),"mouseout",autoSlide);const parallaxItems=$$("[data-parallax-item]");let lastMove=0;window.addEventListener("mousemove",e=>{const t=performance.now();if(t-lastMove<80)return;lastMove=t;const n=e.clientX/window.innerWidth*10-5,a=e.clientY/window.innerHeight*10-5;for(let e=0;e<parallaxItems.length;e++){const t=Number(parallaxItems[e].dataset.parallaxSpeed)||1,s=n*t*-1,i=a*t*-1;parallaxItems[e].style.transform=`translate3d(${s}px, ${i}px, 0)`}},{passive:!0});const initCtaBookingAnimation=()=>{const e=$$('.clandestino-cta-booking .cta-anim[data-animate="active"]');if(!e.length)return;if(!("IntersectionObserver"in window))return void e.forEach(e=>e.classList.add("is-visible"));const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("is-visible"),t.unobserve(e.target))})},{threshold:.15,rootMargin:"0px 0px -50px 0px"});e.forEach(e=>t.observe(e))};function initClosureModal(){const e=document.getElementById("closureModal");if(!e)return;const t=e.querySelector(".closure-modal-content");if(!t)return;setTimeout(function(){e.classList.add("active"),e.setAttribute("aria-hidden","false")},500);let n=setTimeout(function(){a()},2e4);function a(){e.classList.remove("active"),e.setAttribute("aria-hidden","true"),window.closureCountdownInterval&&(clearInterval(window.closureCountdownInterval),window.closureCountdownInterval=null)}e.querySelectorAll("[data-modal-close]").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),clearTimeout(n),a()})}),e.addEventListener("click",function(t){t.target===e&&(clearTimeout(n),a())}),t.addEventListener("click",function(e){e.stopPropagation()}),initCountdownTimer()}function initCountdownTimer(){const e=new Date("2025-11-08T14:00:00").getTime(),t=document.getElementById("countdown-days"),n=document.getElementById("countdown-hours"),a=document.getElementById("countdown-minutes"),s=document.getElementById("countdown-seconds");function i(){const i=(new Date).getTime(),r=e-i;if(r<0)return t.textContent="00",n.textContent="00",a.textContent="00",s.textContent="00",void(window.closureCountdownInterval&&clearInterval(window.closureCountdownInterval));const o=Math.floor(r/864e5),l=Math.floor(r%864e5/36e5),c=Math.floor(r%36e5/6e4),d=Math.floor(r%6e4/1e3);t.textContent=String(o).padStart(2,"0"),n.textContent=String(l).padStart(2,"0"),a.textContent=String(c).padStart(2,"0"),s.textContent=String(d).padStart(2,"0")}t&&n&&a&&s&&(i(),window.closureCountdownInterval=setInterval(i,1e3))}function initMenuGallery(){"undefined"!=typeof jQuery&&void 0!==jQuery.fn.magnificPopup?jQuery(".has-popup-image").magnificPopup({type:"image",gallery:{enabled:!0,tPrev:"Previous",tNext:"Next",tCounter:"%curr% of %total%"},image:{verticalFit:!0,titleSrc:function(e){return e.el.find("img").attr("alt")||""}},removalDelay:160,mainClass:"mfp-fade",closeBtnInside:!0,closeOnContentClick:!1,closeOnBgClick:!0,showCloseBtn:!0}):console.warn("jQuery or Magnific Popup not loaded")}document.addEventListener("DOMContentLoaded",initCtaBookingAnimation),window.addEventListener("load",initCtaBookingAnimation),function(){const e=document.querySelector(".clandestino-swc-history");if(!e)return;const t=e.querySelectorAll(".scroll-animate");e.querySelectorAll(".clandestino-swc-carousel .scroll-animate").forEach(e=>e.classList.add("active"));const n=Array.from(t).filter(e=>!e.closest(".clandestino-swc-carousel"));if("IntersectionObserver"in window&&n.length){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("active"),e.unobserve(t.target))})},{threshold:.1,rootMargin:"0px 0px -10% 0px"});n.forEach(t=>e.observe(t))}else n.forEach(e=>e.classList.add("active"));const a=e.querySelector(".swiper-container");if(a&&"undefined"!=typeof Swiper)try{const t=new Swiper(a,{slidesPerView:1,spaceBetween:0,centeredSlides:!0,loop:!0,loopAdditionalSlides:2,speed:800,autoHeight:!1,watchOverflow:!1,preloadImages:!0,updateOnWindowResize:!0,loopPreventsSliding:!1,autoplay:{delay:6500,disableOnInteraction:!1,pauseOnMouseEnter:!0,waitForTransition:!0},effect:"slide",grabCursor:!0,allowTouchMove:!0,breakpoints:{0:{slidesPerView:1,centeredSlides:!0,spaceBetween:14},520:{slidesPerView:1,centeredSlides:!0,spaceBetween:18},768:{slidesPerView:1,centeredSlides:!0,spaceBetween:22},1024:{slidesPerView:1,centeredSlides:!0,spaceBetween:0}},on:{beforeTransitionStart:function(){this.slides.forEach(e=>{const t=e.querySelector(".clandestino-swc-item");t&&(t.style.transform="")})},slideChangeTransitionStart:function(){const e=this.slides[this.activeIndex];if(e){const t=e.querySelector(".clandestino-swc-item");t&&(t.style.transition="transform .5s ease",t.style.transform="scale(0.965)",requestAnimationFrame(()=>{setTimeout(()=>{t.style.transform="scale(1)"},50)}))}}}});e.addEventListener("mouseenter",()=>{t.autoplay&&t.autoplay.stop()}),e.addEventListener("mouseleave",()=>{t.autoplay&&t.autoplay.start()}),document.addEventListener("keydown",e=>{"ArrowLeft"===e.key&&t.slidePrev(),"ArrowRight"===e.key&&t.slideNext()})}catch(e){console.warn("Clandestino SWC Swiper initialization failed:",e)}}(),function(){const e=document.querySelector(".testimonials-carousel .swiper-container");if(!e)return;new Promise(e=>{if(window.Swiper)return e();const t=document.createElement("script");t.src="https://unpkg.com/swiper@6.8.4/swiper-bundle.min.js",t.async=!0,t.onload=()=>e(),document.head.appendChild(t)}).then(()=>{try{const t=window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,n=e.querySelectorAll(".swiper-wrapper > .swiper-slide").length,a=new Swiper(e,{loop:!0,speed:600,spaceBetween:24,autoHeight:!0,grabCursor:!0,centeredSlides:!1,watchOverflow:!1,autoplay:!t&&{delay:6e3,disableOnInteraction:!1},slidesPerView:3,breakpoints:{0:{slidesPerView:1,spaceBetween:16,centeredSlides:!0},768:{slidesPerView:2,spaceBetween:20},1024:{slidesPerView:2,spaceBetween:20},1200:{slidesPerView:3,spaceBetween:24}},pagination:{el:".testimonials-carousel .swiper-pagination",type:"progressbar"}}),s=e.querySelector(".swiper-pagination");s&&(s.classList.add("testimonials-progressbar"),s.setAttribute("role","progressbar"),s.setAttribute("aria-valuemin","1"),s.setAttribute("aria-valuemax",String(n)));const i=e.parentElement.querySelector(".testimonials-pagination-status"),r=()=>{if(!i)return;const e=a.realIndex+1,t=e.toString().padStart(2,"0"),r=n.toString().padStart(2,"0");i.setAttribute("aria-label",`Client story ${e} of ${n}`),i.innerHTML=`\n          <span class="status-prefix">Client Stories</span>\n          <span class="status-count">\n            <span class="status-current">${t}</span>\n            <span class="status-divider" aria-hidden="true">/</span>\n            <span class="status-total">${r}</span>\n          </span>\n        `,s&&s.setAttribute("aria-valuenow",String(e))};function o(e){const n=e.target;n&&"VIDEO"===n.tagName&&(a.allowTouchMove=!0,a.allowSlideNext=!0,a.allowSlidePrev=!0,!a.autoplay||a.autoplay.running||t||a.autoplay.start(),setTimeout(()=>a.updateAutoHeight(300),50))}function l(){const e=window.innerWidth;a.params.centeredSlides=e<480,a.update()}r(),a.on("slideChange",r),a.on("loopFix",r),a.autoplay&&(e.addEventListener("mouseenter",()=>a.autoplay&&a.autoplay.stop&&a.autoplay.stop()),e.addEventListener("mouseleave",()=>a.autoplay&&a.autoplay.start&&a.autoplay.start())),e.addEventListener("play",e=>{const t=e.target;t&&"VIDEO"===t.tagName&&(a.autoplay&&a.autoplay.running&&a.autoplay.stop(),a.allowTouchMove=!1,a.allowSlideNext=!1,a.allowSlidePrev=!1)},!0),e.addEventListener("pause",o,!0),e.addEventListener("ended",o,!0),e.addEventListener("keydown",t=>{if(" "===t.key||"Enter"===t.key){const t=e.querySelector(".swiper-slide-active video");t&&(t.paused?t.play():t.pause())}}),window.addEventListener("resize",()=>{l(),setTimeout(()=>a.updateAutoHeight(300),60)}),l()}catch(c){}})}(),function(){const e=document.querySelector(".events-carousel .swiper-container");if(!e)return;new Promise(e=>{if(window.Swiper)return e();const t=document.createElement("script");t.src="https://unpkg.com/swiper@6.8.4/swiper-bundle.min.js",t.async=!0,t.onload=()=>e(),document.head.appendChild(t)}).then(()=>{try{const t=new Swiper(e,{loop:!1,speed:550,spaceBetween:26,slidesPerView:3,watchOverflow:!0,grabCursor:!0,breakpoints:{0:{slidesPerView:1,spaceBetween:16},640:{slidesPerView:2,spaceBetween:20},992:{slidesPerView:3,spaceBetween:26}},navigation:{nextEl:".events-carousel .swiper-button-next",prevEl:".events-carousel .swiper-button-prev"},pagination:{el:".events-carousel .swiper-pagination",clickable:!0}});e.addEventListener("keydown",e=>{"ArrowLeft"===e.key&&t.slidePrev(),"ArrowRight"===e.key&&t.slideNext()})}catch(e){}});const t=document.getElementById("eventModal");if(!t)return;const n=document.getElementById("modalTitle"),a=document.getElementById("modalImage"),s=document.getElementById("modalTime"),i=document.getElementById("modalPrice"),r=document.getElementById("modalDescription"),o=t.querySelector(".modal-actions a");let l=null;const c={bocatas:{title:"Bocatas Hour – Authentic Spanish Sandwich Window",time:"Daily 12:00 pm – 2:00 pm",price:"$19.90 (Drink Included)",img:"./assets/images/bocatas/clandestino-sandwich-02.jpeg",description:'\n        <p>Enjoy our dedicated mid‑day <strong>artisan bocatas window</strong>: crusty bread, extra virgin olive oil and classic Spanish fillings served fresh.</p>\n        <h4>Featured Fillings</h4>\n        <ul>\n          <li>Serrano Ham & Manchego</li>\n          <li>Spanish Tortilla with Alioli</li>\n          <li>Ibérico Chorizo & Roasted Peppers</li>\n          <li>Tuna with Fire-Roasted Piquillos</li>\n        </ul>\n        <p>Includes a selected house drink (wine, beer or soft). Limited daily prep – perfect for a quick genuine taste of Spain.</p>\n        <p class="cta-note">Reserve ahead via WhatsApp to avoid selling out.</p>\n      '},"senior-day":{title:"Senior Appreciation Tuesday – 20% Off",time:"Every Tuesday",price:"20% Off",img:"./assets/images/gallery/Clandestino-friends-wine.jpeg",description:'\n        <p>A respectful weekly thank‑you: guests 60+ with valid ID receive <strong>20% off</strong> tapas, wine by the glass and desserts.</p>\n        <p>Bring family, share stories and savor traditional Spanish flavors in a relaxed ambience.</p>\n        <p class="cta-note">Walk‑ins welcome. Groups encouraged to reserve.</p>\n      '},"womens-day":{title:"Women's Wednesday – 50% Off Second Drink",time:"Every Wednesday",price:"50% Off 2nd Drink",img:"./assets/images/events/wednesday.jpg",description:'\n        <p>Celebrating women every week. Order any qualifying drink and the <strong>second of equal or lesser value is 50% off</strong>.</p>\n        <p>Applies to select wines by the glass, vermouth, spritz and signature cocktails.</p>\n        <p class="cta-note">Gather your circle and make it a mid‑week ritual.</p>\n      '},"bottle-day":{title:"Spanish Bottle Thursday – 20% Off",time:"Every Thursday",price:"20% Off Bottles",img:"./assets/images/wines.jpeg",description:'\n        <p>Dive into our curated Spanish wine list with a <strong>20% bottle advantage</strong> every Thursday.</p>\n        <p>Ideal for discovering new DO regions or sharing a reserva with friends.</p>\n        <p class="cta-note">Ask about staff pairing recommendations.</p>\n      '},"paella-friday":{title:"Paella Fridays – Slow‑Fire Tradition",time:"Fridays 12:00 pm – 4:00 pm (Limited Portions)",price:"$15 per serving",img:"./assets/images/clandestino-paella.jpg",description:'\n        <p>Classic saffron rice paella cooked in authentic pans – layered flavors that transport you to Valencia.</p>\n        <p><strong>Limited batches.</strong> Once the pan is gone, it is gone.</p>\n        <p class="cta-note">Pre‑reserve portions via WhatsApp for guaranteed availability.</p>\n      '},"sandwich-day":{title:"Weekend Sandwich Edition – Regional Specials",time:"Every Saturday",price:"$19.90 (With Drink)",img:"./assets/images/bocatas/clandestino-sandwich-01.jpeg",description:'\n        <p>Elevated weekend versions of our signature Spanish sandwiches inspired by rotating regions.</p>\n        <p>Includes selected beverage. Weekly variations keep the experience fresh.</p>\n        <p class="cta-note">Follow us for announced fillings every Friday evening.</p>\n      '},"bottle-painting":{title:"Wine Bottle Art Workshop – Creative & Sustainable",time:"Bi‑weekly (Check Dates)",price:"Free Event",img:"./assets/images/gallery/clandestino-friends-art-5.jpg",description:'\n        <p>Upcycle empty wine bottles into art. All materials provided – just bring imagination.</p>\n        <p>Top seasonal pieces enter a <strong>grand cultural prize selection</strong> focused on Spanish wine & gastronomy.</p>\n        <p>Some works are showcased in‑house and at community features.</p>\n        <p class="cta-note">Spaces fill quickly. Reserve your spot.</p>\n      '},"wine-tourism":{title:"Spanish Wine Journey – Curated Travel Program",time:"Seasonal",price:"Premium Experience",img:"./assets/images/NTC-Travels.jpg",description:'\n        <p>An immersive route across emblematic Spanish wine regions: Rioja, Ribera del Duero, Priorat, Rías Baixas or Jerez (itinerary rotates).</p>\n        <p>Includes boutique winery access, guided tastings, regional pairings and producer encounters.</p>\n        <p>Enrollment tiers (Gold / Diamond) with limited availability.</p>\n        <p class="cta-note">Request the next departure dossier via WhatsApp.</p>\n      '}};function d(){t.classList.remove("active"),document.body.classList.remove("modal-open"),t.setAttribute("aria-hidden","true"),l&&l.focus&&l.focus()}window.openEventModal=function(e){const d=c[e];if(d){if(l=document.activeElement,n.textContent=d.title,a.src=d.img,a.alt=d.title,s.textContent=d.time,i.textContent=d.price,r.innerHTML=d.description,o){const e="https://wa.me/14086090027?text=",t=`Hello! I'm interested in the event: ${d.title}. Could you please share availability, booking details and any requirements? Thank you.`,n=encodeURIComponent(t);o.href=e+n,o.textContent.trim()||(o.textContent="Request Info via WhatsApp"),o.setAttribute("aria-label",`Request more information about ${d.title} via WhatsApp`)}t.classList.add("active"),document.body.classList.add("modal-open"),t.setAttribute("aria-hidden","false"),setTimeout(()=>{const e=t.querySelector("button, .modal-close, a.btn");e&&e.focus()},30)}},window.closeEventModal=d,t.addEventListener("click",e=>{e.target===t&&d()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&t.classList.contains("active")&&d(),function(e){if(!t.classList.contains("active"))return;if("Tab"!==e.key)return;const n=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!n.length)return;const a=n[0],s=n[n.length-1];e.shiftKey&&document.activeElement===a?(e.preventDefault(),s.focus()):e.shiftKey||document.activeElement!==s||(e.preventDefault(),a.focus())}(e)})}(),function(){const e=document.querySelectorAll(".clandestino-menu-item-card");if(!e.length)return;const t=document.querySelectorAll(".clandestino-menu-side-image"),n=document.querySelectorAll(".clandestino-menu-cta-container"),a=[...e,...t,...n];function s(e){e.classList.add("animate-active")}const i=window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!("IntersectionObserver"in window)||i)return void a.forEach(s);const r=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(s(e.target),r.unobserve(e.target))})},{threshold:.15,rootMargin:"0px 0px -5% 0px"});a.forEach(e=>r.observe(e))}(),function(){const e=document.querySelectorAll(".navbar .navbar-link");if(!e.length)return;let t=window.location.pathname.split("/").pop();""!==t&&null!==t||(t="index.html");const n=window.location.hash;e.forEach(e=>{e.classList.remove("active"),e.removeAttribute("aria-current")});let a=!1;if(e.forEach(e=>{const n=e.getAttribute("href");n&&n===t&&(e.classList.add("active"),e.setAttribute("aria-current","page"),a=!0)}),!a){if(["tapas.html","wines.html","hampers.html"].includes(t)){const e=document.querySelector('.navbar .navbar-link[href="menu.html"]');e&&(e.classList.add("active"),e.setAttribute("aria-current","page"),a=!0)}}if(!a&&"index.html"===t){const e=document.querySelector('.navbar .navbar-link[href="#home"], .navbar .navbar-link[href="index.html"]');e&&(e.classList.add("active"),e.setAttribute("aria-current","page"),a=!0)}if(!a&&n){const e=document.querySelector(`.navbar .navbar-link[href='${n}']`);e&&(e.classList.add("active"),e.setAttribute("aria-current","page"),a=!0)}if(!a){const t=e[0];t&&(t.classList.add("active"),t.setAttribute("aria-current","page"))}}(),function(){const e=document.getElementById("clx-contact-form");if(!e)return;const t=e.querySelector(".clx-status"),n=document.getElementById("clx-submit-btn"),a=document.getElementById("clx-csrf-token"),s="clx_csrft_v1";function i(){const e=new Uint32Array(4);return crypto.getRandomValues(e),btoa(Array.from(e).join("-")).replace(/=+/g,"")}sessionStorage.getItem(s)||sessionStorage.setItem(s,i()),a&&(a.value=sessionStorage.getItem(s));const r=["name","email","tel","subject","message"];function o(e,n,a){t&&(t.textContent=e||"",t.className="clx-status"+(n?" clx-status--"+n:""),a?t.setAttribute("aria-busy","true"):t.removeAttribute("aria-busy"))}function l(t,n){const a=e.querySelector('.clx-error[data-error-for="'+t+'"]'),s=e.querySelector('[name="'+t+'"]'),i=s?s.closest(".clx-field-group"):null;a&&(a.textContent=n||""),i&&i.classList.toggle("clx-has-error",!!n),n&&s?s.setAttribute("aria-invalid","true"):s&&s.removeAttribute("aria-invalid")}function c(){r.forEach(e=>l(e,""));let t=!0;e.name.value.trim().length<2&&(l("name","Enter your full name"),t=!1);const n=e.email.value.trim();/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)||(l("email","Valid email required"),t=!1);e.subject.value.trim().length<1&&(l("subject","Please select a subject"),t=!1);e.message.value.trim().length<5&&(l("message","Message too short"),t=!1);const a=e.tel.value.trim();return a&&/[^0-9+()\-\s]/.test(a)&&(l("tel","Invalid characters"),t=!1),t}e.addEventListener("submit",async function(r){if(r.preventDefault(),n.classList.contains("is-loading"))return;if(!c())return void o("Please correct the highlighted fields.","error");if(e.website&&e.website.value)return void o("Unexpected error.","error");o("Sending message...","info",!0),n.classList.add("is-loading"),n.disabled=!0;const l=new FormData(e);try{const t=await fetch(e.action,{method:"POST",headers:{Accept:"application/json"},body:l,credentials:"same-origin"}),n=await t.json().catch(()=>({success:!1,error:"parse"}));n.success?(e.reset(),sessionStorage.setItem(s,i()),a&&(a.value=sessionStorage.getItem(s)),o("Message sent successfully. Thank you!","success")):o(n.errorMessage||"There was an error sending your message.","error")}catch(e){o("Network error. Please try again.","error")}finally{n.classList.remove("is-loading"),n.disabled=!1,t?.removeAttribute("aria-busy")}})}(),function(){const e="clx-contact-form",t="clx-csrf-token",n="clx-submit-btn",a="clx-status",s="loading",i="show",r="error",o="success";let l={},c={},d=!1;const u={name:{required:!0,minLength:2,maxLength:80,pattern:/^[a-zA-ZÀ-ÿ\u00f1\u00d1\s\-'\.]+$/,message:"Please enter a valid name (letters only, 2-80 characters)"},email:{required:!0,maxLength:120,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"},tel:{required:!0,maxLength:30,pattern:/^[0-9+()\-\s]{6,}$/,message:"Please enter a valid phone number"},subject:{required:!0,message:"Please select an inquiry type"},message:{required:!0,minLength:5,maxLength:1500,message:"Please enter a message (5-1500 characters)"}};function p(){l={form:document.getElementById(e),submitBtn:document.getElementById(n),csrfToken:document.getElementById(t),status:document.querySelector("."+a),fields:{}},l.form&&["name","email","tel","subject","message"].forEach(e=>{const t=l.form.querySelector(`[name="${e}"]`),n=l.form.querySelector(`[data-error-for="${e}"]`),a=t?t.closest(".clx-field-group"):null;t&&(l.fields[e]={field:t,errorEl:n,fieldGroup:a},c[e]=!1)}),l.form&&(m(),function(){if(!l.form||!l.submitBtn)return;l.form.addEventListener("submit",g),Object.keys(l.fields).forEach(e=>{const{field:t}=l.fields[e];t&&(t.addEventListener("blur",()=>{c[e]||(c[e]=!0),(c[e]||d)&&f(e),y()}),t.addEventListener("input",()=>{(c[e]||d)&&(v(e),clearTimeout(t._validationTimer),t._validationTimer=setTimeout(()=>{(c[e]||d)&&f(e)},300)),y()}))}),window.addEventListener("beforeunload",()=>{if(l.submitBtn.classList.contains(s))return"Form is being submitted. Are you sure you want to leave?"})}(),y(),console.log("Clandestino contact form initialized"))}function m(){if(!l.csrfToken)return;const e=Math.floor(Date.now()/1e3),t=Math.random().toString(36).substring(2),n=btoa(`${e}.${t}`);l.csrfToken.value=n}function g(e){e.preventDefault(),l.submitBtn.classList.contains(s)||(d=!0,Object.keys(c).forEach(e=>{c[e]=!0}),function(e=!1){let t=!0;if(Object.keys(u).forEach(e=>{f(e,!0)||(t=!1)}),S(t),!t&&e){b("Please correct the highlighted fields.","error");const e=l.form.querySelector(".clx-field-group.error input, .clx-field-group.error select, .clx-field-group.error textarea");return e&&(e.focus({preventScroll:!1}),e.scrollIntoView({behavior:"smooth",block:"center"})),!1}return t}(!0)&&async function(){w(!0),b("Sending your message…","info"),l.status?.setAttribute("aria-busy","true");try{const e=new FormData(l.form),t=await fetch("contact.php",{method:"POST",body:e,headers:{"X-Requested-With":"XMLHttpRequest"}}),n=t.headers.get("content-type");if(!n||!n.includes("application/json"))throw new Error("Server did not return JSON response");const a=await t.json();if(a.success)b("Thank you! Your message has been sent successfully. We'll get back to you soon.","success"),E(),"undefined"!=typeof gtag&&gtag("event","contact_form_submit",{event_category:"Contact",event_label:e.get("subject")||"General"});else{let e="There was an error sending your message. Please try again.";a.errorMessage&&(e=a.errorMessage),b(e,"error"),console.error("Form submission failed:",a)}}catch(e){console.error("Form submission error:",e),b("Network error. Please check your connection and try again. If the problem persists, please call us directly.","error")}finally{w(!1),l.status?.setAttribute("aria-busy","false")}}())}function f(e,t=!0){const{field:n,errorEl:a,fieldGroup:s}=l.fields[e]||{};if(!n||!a||!s)return!0;const i=u[e],r=n.value.trim();return t&&v(e),i.required&&!r?(t&&h(e,i.message||`${e} is required`),!1):!r&&!i.required||(i.minLength&&r.length<i.minLength?(t&&h(e,`Minimum ${i.minLength} characters required`),!1):i.maxLength&&r.length>i.maxLength?(t&&h(e,`Maximum ${i.maxLength} characters allowed`),!1):i.pattern&&!i.pattern.test(r)?(t&&h(e,i.message),!1):"subject"===e&&""===r?(t&&h(e,"Please select an inquiry type"),!1):(t&&(c[e]||d)&&(s.classList.add(o),n.setAttribute("aria-invalid","false")),!0))}function h(e,t){const{errorEl:n,fieldGroup:a,field:s}=l.fields[e]||{};n&&a&&(n.textContent=t,a.classList.add(r),a.classList.remove(o),s&&(s.setAttribute("aria-invalid","true"),s.setAttribute("aria-describedby",n.id)))}function v(e){const{errorEl:t,fieldGroup:n,field:a}=l.fields[e]||{};t&&n&&(t.textContent="",n.classList.remove(r),a&&(a.removeAttribute("aria-invalid"),a.removeAttribute("aria-describedby")))}function y(){let e=!0;return Object.keys(u).forEach(t=>{f(t,!1)||(e=!1)}),S(e),e}function w(e){l.submitBtn&&(l.submitBtn.classList.toggle(s,e),l.submitBtn.disabled=e,l.submitBtn.setAttribute("aria-busy",e?"true":"false"),l.submitBtn.textContent=e?"Sending...":"Send Message")}function b(e,t){if(!l.status)return;const n="success"===t?"checkmark-circle-outline":"error"===t?"alert-circle-outline":"information-circle-outline";l.status.className=`${a}`,l.status.classList.add(i,t),l.status.innerHTML=`<div class="clx-status-inner"><ion-icon name="${n}" aria-hidden="true"></ion-icon><span>${e}</span></div>`,l.status.setAttribute("data-status",t),l.status.setAttribute("role","alert"),l.status.setAttribute("aria-live","polite"),"success"===t&&setTimeout(()=>{!function(){if(!l.status)return;l.status.classList.remove(i,"success","error","info"),l.status.removeAttribute("data-status")}()},1e4),setTimeout(()=>{l.status.scrollIntoView({behavior:"smooth",block:"nearest"})},100)}function S(e){l.submitBtn&&(l.submitBtn.disabled=!e,l.submitBtn.classList.toggle("disabled",!e),l.submitBtn.setAttribute("aria-disabled",e?"false":"true"))}function E(){if(!l.form)return;l.form.reset(),Object.keys(c).forEach(e=>{c[e]=!1}),d=!1,Object.keys(l.fields).forEach(e=>{v(e);const{fieldGroup:t}=l.fields[e]||{};t&&t.classList.remove(o)}),m(),S(!1);const e=l.form.querySelector("input, select, textarea");e&&setTimeout(()=>e.focus(),200)}window.ClandestinoContact={validateField:f,resetForm:E,showStatus:b,checkFormCompleteness:y},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",p):p()}(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){setTimeout(initMenuGallery,500)}):setTimeout(initMenuGallery,500);